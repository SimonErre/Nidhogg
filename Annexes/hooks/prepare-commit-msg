#!/bin/bash
COMMIT_MSG_FILE="$1"

# Ne pas agir si merge/squash/rebase
if [ -n "$2" ]; then
  exit 0
fi

# Forcer le hook Ã  utiliser le terminal pour lâ€™input
exec < /dev/tty

echo ""
echo "ðŸ§  CrÃ©ation du message de commit"
echo "-------------------------------"

# SÃ©lection du type
echo "Type de changement :"
select TYPE in "fix" "feat" "init"; do
  if [[ -n "$TYPE" ]]; then break; fi
done

# SÃ©lection du module
echo "Cible du changement :"
select SCOPE in "web" "mobile" "api"; do
  if [[ -n "$SCOPE" ]]; then break; fi
done

PREFIX="[$TYPE $SCOPE] "

# Si le fichier est vide, on insÃ¨re le prÃ©fixe
if [ ! -s "$COMMIT_MSG_FILE" ]; then
  echo "$PREFIX" > "$COMMIT_MSG_FILE"
else
  sed -i "1s/^/$PREFIX/" "$COMMIT_MSG_FILE"
fi

echo "âœ… PrÃ©fixe ajoutÃ© : $PREFIX"
echo ""
