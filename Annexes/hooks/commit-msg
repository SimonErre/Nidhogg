#!/bin/bash

commit_msg_file="$1"
commit_msg=$(head -n1 "$commit_msg_file")

# RÃ¨gle : le message doit commencer par [fix|feat] suivi dâ€™un espace et dâ€™un scope (web|mobile|api)
pattern='^\[(fix|feat|init) (web|mobile|api)\]'

if ! [[ "$commit_msg" =~ $pattern ]]; then
  echo "âŒ Erreur : le message de commit doit commencer par un prÃ©fixe valide."
  echo ""
  echo "ğŸ‘‰ Format attendu : [fix|feat|init] [web|mobile|api] Votre message ici"
  echo ""
  echo "Exemples valides :"
  echo "  [fix web] correction du bouton de connexion"
  echo "  [feat api] ajout du filtre de recherche"
  echo ""
  echo "ğŸ’¡ Astuce : utilise simplement 'git commit' â€” le hook prepare-commit-msg tâ€™aidera Ã  formater le message."
  exit 1
fi
